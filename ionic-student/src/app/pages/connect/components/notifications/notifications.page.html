<ion-header>
  <ion-toolbar>
    <ion-title>Notifications</ion-title>
    <ion-buttons slot="end">
      <ion-button
        fill="clear"
        color="primary"
        class="pec-text-tr-ini"
        [disabled]="isEmptyInbox || !inboxMessages || globalConfigs.isImpersonatedUser"
        (click)="deleteAllMessage()"
        [pecTrackEvent]="{ category: 'Notification Center', action: 'Tapped to Delete All', label: '', value: '' }"
      >
        Delete All
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content forceOverscroll="false" [pecTrackView]="{ view: 'Notification Center' }">
  <pec-loading *ngIf="showLoading"></pec-loading>

  <ng-container *ngIf="!isEmptyInbox && !showLoading">
    <ion-list>
      <ion-item-divider>
        <ion-label class="pec-fw-700 pec-fs-12 pec-mt-15 pec-mb-15">
          {{ unreadNotificationCount }} UNREAD NOTIFICATION(S)
        </ion-label>
      </ion-item-divider>

      <ion-item-sliding
        #item
        *ngFor="let messageId of objectKeys(inboxMessages)"
        (click)="showInboxMessageDetails(messageId)"
        [pecTrackEvent]="{
          category: 'Notification Center',
          action: 'Tapped to View Notification',
          label: '',
          value: ''
        }"
      >
        <ion-item>
          <ion-row>
            <ion-col size="auto" class="pec-d-flex">
              <img [src]="schoolLogo" alt="school logo" />
            </ion-col>
            <ion-col>
              <div class="pec-fs-12 pec-fw-normal">{{ inboxMessages[messageId].title }}</div>
            </ion-col>
            <ion-col size="auto">
              <span class="pec-fs-12">
                <ion-badge *ngIf="!inboxMessages[messageId].isRead"></ion-badge>
                <span>{{ getMessageDuration(inboxMessages[messageId].sentDate) }}</span>
              </span>
            </ion-col>
          </ion-row>
        </ion-item>

        <ion-item-options side="end">
          <button
            (click)="deleteMessage(inboxMessages[messageId].id)"
            [disabled]="globalConfigs.isImpersonatedUser"
            [pecTrackEvent]="{
              category: 'Notification Center',
              action: 'Tapped to Delete Notification',
              label: '',
              value: ''
            }"
          >
            <i class="pec-icon-thin-x-mark"></i>
            <span class="pec-text-white">Delete</span>
          </button>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>
  </ng-container>

  <ion-card *ngIf="isEmptyInbox && !showLoading" class="no-notifications">
    You currently do not have any notifications.
  </ion-card>
</ion-content>
