<ion-item-sliding>
  <ion-item class="card-item">
    <ion-card *ngIf="assignment.IsAssignment">
      <ion-card-header
        class="pec-p-0 pec-bw-bottom-1 pec-bc-card-header"
        aria-label="Tap to view graded assignments"
        (click)="goToGradedAssignmentPage()"
      >
        <ion-grid>
          <ion-row class="assignment-card-header-row">
            <ion-col class="assignment-card-header-title pec-d-flex-grow-1 pec-pr-0">ASSIGNMENT</ion-col>
            <ion-col class="pec-py-0 grade-box-col">
              <ion-row
                *ngIf="assignment.IsGraded"
                class="grade-box pec-d-flex pec-d-align-items-center pec-bw-1 pec-br-4 bed-bc-dark pec-text-black"
                [pecTrackEvent]="{
                  category: 'Classroom View',
                  action: 'Tapped to View Assignment Grade',
                  label: 'Assignment Graded',
                  value: '',
                  classId: classInfo.ClassId
                }"
              >
                <div class="grade-box-grade-wrap grade-letter-box pec-bg-dark pec-text-white">
                  <h2
                    *ngIf="assignment.GradeLetter && !gradeMasked"
                    class="grade-letter pec-fw-700 pec-m-0 pec-fs-16 pec-p-5"
                  >
                    {{ assignment.GradeLetter.toUpperCase() }}
                  </h2>
                </div>
                <span
                  *ngIf="!gradeMasked"
                  class="pec-px-5 pec-fs-11 pec-text-center pec-d-flex-grow-1 pec-text-spacing-0"
                >
                  {{ assignment.EarnedPoints / assignment.PossiblePoints | percent: '1.1-1' }}
                </span>
                <span
                  *ngIf="gradeMasked"
                  class="grade-mask pec-font-default-bold pec-fs-12 pec-text-center pec-px-5 pec-fw-700 pec-text-tr-ini"
                >
                  Not yet
                  <br />
                  participated
                </span>
              </ion-row>
            </ion-col>
            <ion-col
              class="grade-box1-col pec-px-4 pec-py-0 pec-d-flex-grow-0"
              *ngIf="
                assignment.IsExtraCredit ||
                assignmentPart ||
                (assignment.IsGradable && assignment.IsGraded && !gradeMasked) ||
                (assignment.IsGradable && !assignment.IsGraded) ||
                (assignment.IsGradable && gradeMasked) ||
                (!assignment.IsGradable && gradeMasked)
              "
            >
              <div class="pec-px-1 pec-py-4 pec-br-4 pec-bw-1 bed-bc-dark">
                <div class="pec-text-dark pec-fs-10 pec-fw-700 pec-text-center">
                  <span
                    *ngIf="assignment.IsExtraCredit"
                    class="
                      pec-text-white-space-no-wrap
                      pec-font-default-extrabold
                      pec-d-block
                      pec-text-dark
                      pec-fw-800
                      pec-fs-11
                      pec-text-center
                      pec-px-4
                    "
                  >
                    EXTRA CREDIT
                  </span>
                  <h2
                    *ngIf="assignmentPart"
                    class="
                      pec-d-block
                      pec-text-dark
                      pec-fw-400
                      pec-fs-11
                      pec-text-center
                      pec-text-white-space-no-wrap
                      pec-m-0
                      pec-lh-11
                    "
                  >
                    {{ assignment.AssignmentPart.length }} PART ASSIGNMENT:
                  </h2>
                  <span
                    *ngIf="assignment.IsGradable && assignment.IsGraded && !gradeMasked"
                    class="
                      pec-text-white-space-no-wrap
                      pec-d-block
                      pec-text-dark
                      pec-fw-700
                      pec-fs-10
                      pec-text-center
                      pec-px-4
                    "
                    [pecTrackEvent]="{
                      category: 'Classroom View',
                      action: 'Tapped to View Assignment Grade',
                      label: 'Assignment Graded',
                      value: '',
                      classId: classInfo.ClassId
                    }"
                  >
                    <span
                      class="pec-d-block pec-text-dark pec-font-default-extrabold pec-fw-800 pec-fs-11 pec-text-center"
                    >
                      {{ assignment.EarnedPoints }}/{{ assignment.PossiblePoints }}
                    </span>
                    POINTS EARNED
                  </span>
                  <span
                    *ngIf="(assignment.IsGradable && !assignment.IsGraded) || (assignment.IsGradable && gradeMasked)"
                    class="
                      pec-text-white-space-no-wrap
                      pec-d-block
                      pec-text-dark
                      pec-fw-700
                      pec-fs-10
                      pec-text-center
                      pec-px-4
                    "
                    [pecTrackEvent]="{
                      category: 'Classroom View',
                      action: 'Tapped to View Assignment Grade',
                      label: 'Assignment Not Graded',
                      value: '',
                      classId: classInfo.ClassId
                    }"
                  >
                    <span
                      class="pec-d-block pec-text-dark pec-font-default-extrabold pec-fw-800 pec-fs-11 pec-text-center"
                    >
                      {{ assignment.PossiblePoints }}
                    </span>
                    POINTS POSSIBLE
                  </span>
                  <span
                    *ngIf="!assignment.IsGradable && gradeMasked"
                    class="
                      pec-text-white-space-no-wrap
                      pec-d-block
                      pec-text-dark
                      pec-fw-700
                      pec-fs-10
                      pec-text-center
                      pec-px-4
                    "
                  >
                    <span>POINTS POSSIBLE:</span>
                    <span
                      class="pec-d-block pec-text-dark pec-font-default-extrabold pec-fw-800 pec-fs-11 pec-text-center"
                    >
                      &nbsp;N/A
                    </span>
                  </span>
                </div>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-header>
      <ion-card-content class="pec-p-0">
        <ion-grid class="pec-p-6">
          <ion-row aria-label="'Tap to visit Assignment Overview'" (click)="goToOverviewPage()">
            <ion-col class="assignment-title pec-fs-17 pec-fw-700 pec-pb-0">
              {{ assignment.AssignmentName }}
            </ion-col>
          </ion-row>
          <ion-row *ngIf="isCustom" aria-label="'Tap to visit Assignment Overview'" (click)="goToOverviewPage()">
            <ion-col
              [pecTrackEvent]="{
                category: 'Classroom View',
                action: 'Tapped Assignment Title',
                label: assignment.HasInClassSubmissionFeature
                  ? '	In-Class Submission'
                  : assignment.HasInClassAssessmentFeature
                  ? 'In-Class Assessment'
                  : assignment.HasAssessmentFeature
                  ? 'Assessment'
                  : assignment.HasDiscussionBoardFeature
                  ? 'Discussion Board'
                  : assignment.HasLiveChatFeature
                  ? 'Live Chat'
                  : assignment.AssignmentTypeName,
                value: '',
                classId: classInfo.ClassId
              }"
              class="assignment-type pec-font-style-italic pec-fs-17"
            >
              {{ assignment.AssignmentTypeName }}
            </ion-col>
          </ion-row>
          <ion-row
            *ngIf="isCustom && (assignment.HasInClassSubmissionFeature || assignment.HasInClassAssessmentFeature)"
            aria-label="'Tap to visit Assignment Overview'"
            (click)="goToOverviewPage()"
          >
            <ion-col
              [pecTrackEvent]="{
                category: 'Classroom View',
                action: 'Tapped Assignment Title',
                label: assignment.HasInClassSubmissionFeature
                  ? '	In-Class Submission'
                  : assignment.HasInClassAssessmentFeature
                  ? 'In-Class Assessment'
                  : assignment.HasAssessmentFeature
                  ? 'Assessment'
                  : assignment.HasDiscussionBoardFeature
                  ? 'Discussion Board'
                  : assignment.HasLiveChatFeature
                  ? 'Live Chat'
                  : assignment.AssignmentTypeName,
                value: '',
                classId: classInfo.ClassId
              }"
              class="assignment-inclass pec-fs-12 pec-fw-700 pec"
            >
              <i>
                This assignment includes an in-class
                {{ assignment.HasInClassAssessmentFeature ? 'assessment' : 'submission' }}
              </i>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="assignmentPart" class="assignment-part-title">
            <ion-col>
              Part {{ assignmentPart.DisplayOrder }} of {{ assignment.AssignmentPart.length }}:
              {{ assignmentPart.Title }}
            </ion-col>
          </ion-row>
          <ion-row aria-label="'Tap to visit Assignment Overview'" (click)="goToOverviewPage()">
            <ion-col class="course-code pec-fs-12 pec-pb-10 pec-text-dark">
              <span>
                {{ classInfo.CourseCode }} | Due:
                <ng-container *ngIf="!isOrientation">
                  {{ (assignmentPart ? assignmentPart.DueDate : assignment.DueDate) | pecDate: 'MMMM d' | async }}
                </ng-container>
                <ng-container *ngIf="isOrientation">N/A</ng-container>
              </span>
              <span *ngIf="isAssignmentDismissed" class="assignment-finished-wrap">
                |
                <span class="pec-text-success">
                  <i class="pec-icon-check-single"></i>
                  Finished
                </span>
              </span>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col *ngFor="let currentAction of assignmentActions">
              <pec-assignment-action-button [currentAction]="currentAction"></pec-assignment-action-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>
    </ion-card>
    <ion-card *ngIf="!assignment.IsAssignment && !assignment.IsArchive && !meetingEnded">
      <ion-card-header class="pec-px-0 pec-py-6 pec-bw-bottom-1 pec-bc-card-header">
        <ion-grid>
          <ion-row class="assignment-card-header-row">
            <ion-col *ngIf="assignment.liveMeetingType" class="pec-text-primary pec-fs-14 pec-fw-600 pec-d-flex-grow-1">
              {{ assignment.liveMeetingType }}
            </ion-col>
            <ion-col
              *ngIf="!assignment.liveMeetingType"
              class="pec-text-primary pec-fs-14 pec-fw-600 pec-d-flex-grow-0"
            >
              ASSIGNMENT
            </ion-col>
            <ion-col class="pec-px-4 pec-py-0 pec-d-flex-grow-0">
              <div class="status-box">
                <span class="upcoming-meeting pec-fw-600" *ngIf="launchMeeting">UPCOMING</span>
                <span class="live-meeting" *ngIf="afterLiveStart && beforeLiveEnd">&#x25BA; LIVE NOW</span>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-header>
      <ion-card-content class="pec-p-0">
        <ion-grid>
          <ion-row aria-label="Tap to Launch Live Chat" (click)="launchLiveChat()">
            <ion-col
              [pecTrackEvent]="{
                category: 'Classroom View',
                action: 'Tapped Assignment Title',
                label: 'Live Chat',
                value: '',
                classId: classInfo.ClassId
              }"
              class="assignment-title pec-fs-17 pec-fw-700 pec-text-black pec-pb-0"
            >
              {{ assignment.Title }}
            </ion-col>
          </ion-row>
          <ion-row aria-label="Tap to Launch Live Chat" (click)="launchLiveChat()">
            <ion-col class="course-code pec-fs-12 pec-pb-10 pec-text-dark">
              <span>
                {{ classInfo.CourseCode }} | {{ assignment.StartDateTime | pecDate: 'MMMM d' | async }} at
                {{ startDateTimeChat }}
                {{ timeZoneCode }}
              </span>
            </ion-col>
          </ion-row>
          <!-- display ion-buttons when the meeting is yet to begin or live or archived -->
          <ion-row>
            <ion-col *ngFor="let currentAction of assignmentActions">
              <pec-assignment-action-button [currentAction]="currentAction"></pec-assignment-action-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>
    </ion-card>
    <ion-card
      class="pec-px-0 pec-py-6 pec-bw-bottom-1 pec-bc-card-header"
      *ngIf="!assignment.IsAssignment && assignment.IsArchive"
    >
      <ion-card-header class="pec-p-0 pec-bw-bottom-1 pec-bc-card-header">
        <ion-grid>
          <ion-row class="assignment-card-header-row">
            <ion-col class="pec-text-primary pec-fs-14 pec-fw-600 pec-d-flex-grow-1">
              {{ assignment.liveMeetingType }}
            </ion-col>
            <ion-col class="pec-px-4 pec-py-0 pec-d-flex-grow-0">
              <div class="status-box">
                <span class="concluded-meeting">{{ globalConfigs.themeId == 9 ? 'ARCHIVED' : 'RECORDED' }}</span>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-header>
      <ion-card-content class="pec-p-0">
        <ion-grid>
          <ion-row
            *ngIf="assignment.MeetingRecordedStatusId === 5"
            aria-label="Tap to Launch Archived Chat"
            (click)="launchZoomArchiveChat()"
          >
            <ion-col
              [pecTrackEvent]="{
                category: 'Classroom View',
                action: 'Tapped Assignment Title',
                label: 'Live Chat',
                value: '',
                classId: classInfo.ClassId
              }"
              class="assignment-title pec-fs-17 pec-fw-700 pec-text-black pec-pb-0"
            >
              {{ assignment.Title }}
            </ion-col>
          </ion-row>
          <ion-row
            *ngIf="assignment.MeetingRecordedStatusId === 5"
            aria-label="Tap to Launch Archived Chat"
            (click)="launchZoomArchiveChat()"
          >
            <ion-col class="course-code pec-fs-12 pec-pb-10 pec-text-dark">
              <span>
                {{ classInfo.CourseCode }} | {{ assignment.StartDateTime | pecDate: 'MMMM d' | async }} at
                {{ startDateTimeChat }}
                {{ timeZoneCode }}
              </span>
            </ion-col>
          </ion-row>
          <!-- display ion-buttons when the meeting is yet to begin or live or archived -->
          <ion-row>
            <ion-col *ngFor="let currentAction of assignmentActions">
              <pec-assignment-action-button [currentAction]="currentAction"></pec-assignment-action-button>
            </ion-col>
          </ion-row>
          <ion-row class="row" *ngIf="assignment.MeetingRecordedStatusId !== 5">
            <ion-col class="not-available-text pec-text-secondary pec-fs-12">
              <b>Conversion in Progress</b>
              <br />
              <span class="ion-text-wrap">
                Live meetings are usually available on the app 1-2 hours after they end.
              </span>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>
    </ion-card>
  </ion-item>
  <ion-item-options class="pec-swipeoptions">
    <div class="swipe-btn-wrap">
      <ion-button
        class="swipeoptions-calendar-btn"
        [pecTrackEvent]="{
          category: 'Classroom View',
          action: 'Tapped to Add to Calendar',
          label: assignment.IsAssignment ? 'Assignments' : (assignment.gaMeetingType | titlecase),
          value: '',
          classId: classInfo.ClassId
        }"
        [disabled]="!(assignment && classInfo)"
        (click)="closeSlidingItem()"
        [pecAddToCalendar]="getAssignmentCalendarEvent()"
      >
        <div>
          <h6 class="pec-icon pec-icon-tasks pec-text-icon-on-dark pec-fs-24 pec-pb-4 pec-m-0"></h6>
          Add to
          <br />
          Calendar
        </div>
      </ion-button>

      <ion-button
        (click)="markAsFinished(true)"
        *ngIf="assignment.IsAssignment && !isAssignmentDismissed"
        [pecTrackEvent]="{
          category: 'Classroom View',
          action: 'Tapped Assignment Completion',
          label: 'Finished',
          value: '',
          classId: classInfo.ClassId
        }"
        class="swipeoptions-marker-btn"
      >
        <div>
          <h6 class="pec-icon pec-icon-thick-checkmark pec-fs-20 pec-pb-4 pec-m-0 pec-text-success"></h6>
          Mark as
          <br />
          Finished
        </div>
      </ion-button>

      <ion-button
        (click)="markAsFinished(false)"
        *ngIf="assignment.IsAssignment && isAssignmentDismissed"
        [pecTrackEvent]="{
          category: 'Classroom View',
          action: 'Tapped Assignment Completion',
          label: 'Unfinished',
          value: '',
          classId: classInfo.ClassId
        }"
        class="swipeoptions-marker-btn"
      >
        <div>
          <h6 class="pec-icon pec-icon pec-icon-refresh pec-text-icon-on-dark pec-fs-20 pec-pb-4 pec-m-0"></h6>
          Mark as
          <br />
          Unfinished
        </div>
      </ion-button>
    </div>
  </ion-item-options>
</ion-item-sliding>
